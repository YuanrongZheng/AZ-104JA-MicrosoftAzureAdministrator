---
lab:
    title: '03b - ARM テンプレートを使用して Azure リソースを管理する'
    module: 'モジュール 03 - Azure 管理'
---

# ラボ 03b - ARM テンプレートを使用して Azure リソースを管理する
# 受講者用ラボ マニュアル

## ラボ シナリオ
Azure portal を使用して、リソースのプロビジョニングとリソース グループに基づく構成に関連する基本的な Azure 管理機能を確認したので、Azure Resource Manager テンプレートを使用して同等のタスクを実行する必要があります。

## 目標

このラボでは、次の内容を学習します。

+ タスク 1: Azure マネージド ディスクのデプロイに使用する ARM テンプレートをレビューする
+ タスク 2: ARM テンプレートを使用して Azure マネージド ディスクを作成する 
+ タスク 3: マネージド ディスクの ARM テンプレートベースのデプロイを確認する

## 予想時間: 20分間

## 指示

### 演習 1

#### タスク 1: Azure マネージド ディスクのデプロイに使用する ARM テンプレートをレビューする

このタスクでは、Azure Resource Manager のテンプレートを使用して Azure ディスク リソースを作成します。

1. [Azure portal](https://portal.azure.com) にログインします。

1. Azure ポータルで、**「リソース グループ」** を検索して選択します。  

1. リソース グループの一覧で、 「**az104-03a-rg1**」 をクリックします。 

1. 「**az104-03a-rg1 リソース グループ**」 ブレードの 「**設定**」 セクションで、「**デプロイ**」 をクリックします。     

1. **az104-03a-rg1 - Deployments** ブレードで、デプロイ リストの最初の項目をクリックしてから、**View template** (テンプレートの表示) をクリックします。   

    >**注**: テンプレートのコンテンツを確認し、ローカル コンピューターにダウンロードしてライブラリに追加し、再デプロイするオプションがあることに注意します。

1. 「**ダウンロード**」 をクリックし、テンプレートとパラメータ ファイルを含む圧縮ファイルをラボ コンピューターの **Downloads** フォルダーに保存します 

1. ダウンロードしたファイルの内容をラボ コンピューターの **Downloads** フォルダーに抽出します。 

    >**注**: これらのファイルは **、\\Allfiles\\Labs\\\03\az104-03b-md-template.json** および **\\Allfiles\\Labs\\03\\az104-03b-md-parameters.json**で入手可能です。

#### タスク 2: ARM テンプレートを使用して Azure マネージド ディスクを作成する 

1. Azure ポータルで、「**テンプレートのデプロイ (カスタム テンプレートを使用したデプロイ**」を検索して選択します。 

1. 「**カスタムデプロイ**」 ブレードで、「**エディターで独自のテンプレートを作成**」 をクリックします。

1. 「**テンプレートの編集**」 ブレードで、「**ファイルの読み込み**」 をクリックし、前の手順でダウンロードしたテンプレート ファイルをアップロードします。   

1. エディター ウィンドウで、次の行を削除します。

   ```json
   "sourceResourceId": {
       "type": "String"
   },
   "sourceUri": {
       "type": "String"
   },
   "osType": {
       "type": "String"
   },
   ```

   ```json
   },
   "hyperVGeneration": {
       "defaultValue": "V1",
       "type": "String"
   ```

   ```json
   "osType": "[parameters('osType')]"
   ```

    >**注意**: これらのパラメーターは、現在のデプロイには適用されないので削除されます。特に、sourceResourceId、sourceUri、osType および hyperVGeneration パラメーターは、既存の VHD ファイルから Azure ディスクを作成するのに適用できます。

1. さらに、次の行から末尾のコンマを削除します。

   ```json
   "diskSizeGB": "[parameters('diskSizeGb')]",
   ```

    >**注**: これは、JSON ベースの ARM テンプレートの構文規則を考慮するために必要です。

1. 変更内容を保存します｡

1. 「**カスタム デプロイ**」 ブレードに戻って、 「**パラメーターを編集**」 をクリックします。

1. 「**パラメーターの編集**」 ブレードで、「**ファイルの読み込み**」 をクリックし、パラメーター ファイル **\\Allfiles\\Labs\\03\az104-03b-md-parameters.json** をアップロードし、変更を保存します。     

1. 「**カスタムデプロイ**」 ブレードに戻って、次の設定を指定します。

    | 設定 | 値 |
    | --- |--- |
    | サブスクリプション | このラボで使用している Azure サブスクリプションの名前 |
    | リソース グループ | 新しいリソース グループ **az104-03b-rg1** の名前 |
    | 場所 | このラボで使用しているサブスクリプションで使用できる Azure リージョンの名前 |
    | ディスク名 | **az104-03b-disk1** |
    | 場所 | 既定値を受け入れる |
    | SKU | **Standard_LRS** |
    | ディスク サイズ GB | **32** |
    | オプションを作成する | **empty** |

1. **「上記の条項と条件に同意します」** チェックボックスを選択し、**「購入」** をクリックします。

1. デプロイが正常に完了したことを確認します。

#### タスク 3: マネージド ディスクの ARM テンプレートベースのデプロイを確認する

1. Azure ポータルで、**「リソース グループ」** を検索して選択します。  

1. リソース グループの一覧で、 「**az104-03b-rg1**」 をクリックします。

1. 「**az104-03b-rg1 リソース グループ ブレード**」 の 「**設定**」 セクションで、「**デプロイ**」 をクリックします。

1. 「**az104-03b-rg1 - 展開**」 ブレードから、デプロイの一覧の最初のエントリをクリックし、**「入力」** ブレードと **「テンプレート」** ブレードの内容を確認 します。     

#### リソースのクリーンアップ

   >**注**: この課題で展開したリソースは、このモジュールの次のラボで使用するため削除しないでください。

#### レビュー

このラボでは次の内容を学習しました。

- Azure マネージド ディスクのデプロイに関する ARM テンプレートのレビュー
- ARM テンプレートを使用して Azure マネージド ディスクの作成
- マネージド ディスクの ARM テンプレートベースのデプロイメントの確認
